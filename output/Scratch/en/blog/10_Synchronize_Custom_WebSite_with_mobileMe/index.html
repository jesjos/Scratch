<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="fr" xml:lang="fr">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
        
        
        <meta name="keywords" content="Apple, mobileme, WebDav, synchronisation, zsh, script">
        
        <link rel="shortcut icon" type="image/x-icon" href="/Scratch/img/favicon.ico" />
        <link rel="stylesheet" type="text/css" href="/Scratch/assets/css/main.css" />
        <link rel="stylesheet" type="text/css" href="/Scratch/css/twilight.css" />
        <link rel="stylesheet" type="text/css" href="/Scratch/css/idc.css" />
        <link rel="alternate" type="application/rss+xml" title="RSS" href="http://feeds.feedburner.com/yannespositocomen"/>
        
        <link rel="alternate" lang="fr" xml:lang="fr" title="Héberger son site personnel sur le site mobileMe" type="text/html" hreflang="fr" href="/Scratch/fr/blog/10_Synchronize_Custom_WebSite_with_mobileMe/" /> 
        <link rel="alternate" lang="en" xml:lang="en" title="Synchronize Custom WebSite with mobileMe" type="text/html" hreflang="en" href="/Scratch/en/blog/10_Synchronize_Custom_WebSite_with_mobileMe/" /> 
        <script type="text/javascript" src="/Scratch/js/jquery-1.3.1.min.js"></script>
        <script type="text/javascript" src="/Scratch/js/jquery.cookie.js"></script>
        <script type="text/javascript" src="/Scratch/js/index.js"></script>
        <!--[if lt IE 9]>
        <script src="http://ie7-js.googlecode.com/svn/version/2.1(beta4)/IE9.js"></script>
        <![endif]-->
        <title>Synchronize Custom WebSite with mobileMe</title>
    </head>
    <body lang="en" class="article">
        <script type="text/javascript">// <![CDATA[
            document.write('<div id="blackpage"><img src="/Scratch/img/loading.gif" alt="loading..."/></div>');
            // ]]>
        </script>

        <div id="content">

            <div id="choix"> 
                <div class="return"><a href="#entete">&darr; Menu &darr;</a></div>
                <div id="choixlang">
                    <a href="/Scratch/fr/blog/10_Synchronize_Custom_WebSite_with_mobileMe/" onclick="setLanguage('fr')">en Français</a>
                </div>
                <div class="flush"></div>
            </div>
            <div id="titre">
                <h1>
                    Synchronize Custom WebSite with mobileMe
                </h1>
                
            </div>
            <div class="flush"></div>

            

            

            <div class="flush"></div>
            <div id="afterheader">
                <div class="corps">
                    <h1 class="first" id="update-small20120111small">Update <small>(2012/01/11)</small></h1>

<p>iDisk should soon disapear. This entry is mainly obsolescent now.</p>

<h1 id="update-small20091028small">Update <small>(2009/10/28)</small></h1>

<p>I <a href="/Scratch/en/blog/2009-10-28-custom-website-synchronisation-with-mobileme--2-">updated my script</a> which is now incremental. Since the writing of this article, Apple<small>&copy;</small> had made many efforts about the bandwith of its European servers.</p>


</div>

<div class="corps">


<h1 class="first" id="webdav-terror">WebDav terror</h1>

<p>I live in France and iDisk upload is just terrible. Upload speed remind me the old 56k modem. Most operations such as list the content of a directory take at least 30 seconds (for 15 elements). Renaming a directory fail most of time.</p>

<p>Apple<small>&copy;</small> use a WebDav server to host files. It works on port 80 (like http). I realized WebDav via https work better (2 to 3 times faster with far less errors). But even https is too slow.</p>

<p>I upload from my Mac and sometimes from an Ubuntu PC (iDisk mounted with webdavfs).</p>

<h1 id="synchronize-safely-the-website">Synchronize safely the website</h1>

<p>Here is the script I use in order to synchronize my website with maximum safety. It try each operations until it works.</p>

<p>The idea are: </p>

<ul>
  <li>synchronize to a temporary folder then swap the name therefore the website isn&rsquo;t accessible only during the swap time. It takes only the time of two rename.</li>
  <li>reiterate all operations until they work (for example, renaming).</li>
</ul>

<p>For now I use <code>rsync</code> which in fact is no more efficient than a simple <code>cp</code> with WebDav. And I should use a method to keep track of elements who have changed. before the publication.</p>

<p>In fact when I&rsquo;m on a Mac, I use <a href="http://www.panic.com/transmit">Transmit</a> which is very cool and far more efficient than the Finder to synchronize files. After the synchronization, I swap the directories.</p>

<p>My script take a <code>-s</code> option in order to make only the swap option. It also take a <code>-a</code> in order to put the new <code>index.html</code> which should point to the new homepage (not the iWeb one).</p>

<p>In order to keep this script working for you, just modify the username by yours (the value of the <code>mobileMeUser</code>).</p>

<div class="fr">
<div class="code"><div class="file"><a href="/Scratch/en/blog/10_Synchronize_Custom_WebSite_with_mobileMe/code/publish"> &#x27A5; publish </a></div><div class="withfile">
<pre class="twilight">
<span class="Comment"><span class="Comment">#</span>!/usr/bin/env zsh</span>

<span class="Comment"><span class="Comment">#</span> Script synchronisant le site sur me.com</span>
<span class="Comment"><span class="Comment">#</span> normalement, le site est indisponible le moins de temps possible</span>
<span class="Comment"><span class="Comment">#</span> le temps de deux renommages de répertoire</span>

mobileMeUser=<span class="String"><span class="String">&quot;</span>yann.esposito<span class="String">&quot;</span></span>
siteName=<span class="String"><span class="String">&quot;</span>siteName<span class="String">&quot;</span></span>

<span class="Comment"><span class="Comment">#</span> Depending of my hostname the </span>
<span class="Keyword">if</span> [[ <span class="String"><span class="String">$(</span>hostname<span class="String">)</span></span> <span class="Keyword">==</span> <span class="String"><span class="String">'</span>ubuntu<span class="String">'</span></span> ]]<span class="Keyword">;</span> <span class="Keyword">then</span>
    iDisk=<span class="String"><span class="String">'</span>/mnt/iDisk<span class="String">'</span></span>
<span class="Keyword">else</span>
    iDisk=<span class="String"><span class="String">&quot;</span>/Volumes/<span class="StringVariable"><span class="StringVariable">$</span>mobileMeUser</span><span class="String">&quot;</span></span>
<span class="Keyword">fi</span>

root=<span class="Variable"><span class="Variable">$</span>HOME</span>/Sites/<span class="Variable"><span class="Variable">$</span>siteName</span>
destRep=<span class="Variable"><span class="Variable">$</span>iDisk</span>/Web/Sites/<span class="Variable"><span class="Variable">$</span>siteName</span>

[[ <span class="Keyword">!</span> -d <span class="Variable"><span class="Variable">$</span>root</span> ]] <span class="Keyword">&amp;&amp;</span> { 
    print -- <span class="String"><span class="String">&quot;</span><span class="StringVariable"><span class="StringVariable">$</span>root</span> n'existe pas ; vérifiez la conf<span class="String">&quot;</span></span> <span class="Keyword">&gt;&amp;2</span><span class="Keyword">;</span> 
    exit 1 
}

[[ <span class="Keyword">!</span> -d <span class="Variable"><span class="Variable">$</span>destRep</span> ]] <span class="Keyword">&amp;&amp;</span> { 
    print -- <span class="String"><span class="String">&quot;</span><span class="StringVariable"><span class="StringVariable">$</span>destRep</span> n'existe pas, veuillez remonter le FS<span class="String">&quot;</span></span> <span class="Keyword">&gt;&amp;2</span><span class="Keyword">;</span> 
    exit 1 
}

<span class="Keyword">if</span> [[ <span class="Variable"><span class="Variable">$</span>1</span> <span class="Keyword">==</span> <span class="String"><span class="String">'</span>-h<span class="String">'</span></span> ]]<span class="Keyword">;</span> <span class="Keyword">then</span>
    print -- <span class="String"><span class="String">&quot;</span>usage: <span class="StringVariable"><span class="StringVariable">$</span>0</span>:h [-h|-a|-s]<span class="String">&quot;</span></span>
    print -- <span class="String"><span class="String">&quot;</span>  -a sychronise aussi l'index<span class="String">&quot;</span></span>
    print -- <span class="String"><span class="String">&quot;</span>  -h affiche l'aide<span class="String">&quot;</span></span>
    print -- <span class="String"><span class="String">&quot;</span>  -s swappe simplement les répertoires<span class="String">&quot;</span></span>
<span class="Keyword">fi</span>

<span class="Keyword">if</span> [[ <span class="Variable"><span class="Variable">$</span>1</span> <span class="Keyword">==</span> <span class="String"><span class="String">'</span>-a<span class="String">'</span></span> ]]<span class="Keyword">;</span> <span class="Keyword">then</span>
    print -- <span class="String"><span class="String">&quot;</span>Synchronisation de l'index (<span class="StringVariable"><span class="StringVariable">${</span>destRep:h<span class="StringVariable">}</span></span>)<span class="String">&quot;</span></span>
    rsync -av <span class="Variable"><span class="Variable">$</span>root</span>/index.html <span class="Variable"><span class="Variable">${</span>destRep:h<span class="Variable">}</span></span>/index.html
<span class="Keyword">fi</span>

print -- <span class="String"><span class="String">&quot;</span>Root = <span class="StringVariable"><span class="StringVariable">$</span>root</span><span class="String">&quot;</span></span>
print -- <span class="String"><span class="String">&quot;</span>Dest = <span class="StringVariable"><span class="StringVariable">$</span>destRep</span><span class="String">&quot;</span></span>

<span class="Keyword">if</span> [[ <span class="Keyword">!</span> <span class="Variable"><span class="Variable">$</span>1</span> = <span class="String"><span class="String">'</span>-s<span class="String">'</span></span> ]]<span class="Keyword">;</span> <span class="Keyword">then</span>
    [[ <span class="Keyword">!</span> -d <span class="Variable"><span class="Variable">$</span>destRep</span>.tmp ]] <span class="Keyword">&amp;&amp;</span> mkdir <span class="Variable"><span class="Variable">$</span>destRep</span>.tmp
    print -P -- <span class="String"><span class="String">&quot;</span>%B[Sync =&gt; tmp]%b<span class="String">&quot;</span></span>
    result=1
    essai=1
    <span class="Keyword">while</span> (( <span class="Variable"><span class="Variable">$</span>result</span> <span class="Keyword">&gt;</span> 0 ))<span class="Keyword">;</span> <span class="Keyword">do</span>
        rsync -arv <span class="Variable"><span class="Variable">$</span>root</span>/Scratch/ <span class="Variable"><span class="Variable">$</span>destRep</span>.tmp
        result=<span class="Variable"><span class="Variable">$</span>?</span>
        <span class="Keyword">if</span> (( <span class="Variable"><span class="Variable">$</span>result</span> <span class="Keyword">&gt;</span> 0 ))<span class="Keyword">;</span> <span class="Keyword">then</span>
            print -P -- <span class="String"><span class="String">&quot;</span>%BEchec du rsync%b (essai n°<span class="StringVariable"><span class="StringVariable">$</span>essai</span>)<span class="String">&quot;</span></span> <span class="Keyword">&gt;&amp;2</span>
        <span class="Keyword">fi</span>
        ((essai++))
    <span class="Keyword">done</span>
<span class="Keyword">fi</span>

<span class="Comment"><span class="Comment">#</span> SWAP</span>
print -P -- <span class="String"><span class="String">&quot;</span>%B[Swap des Répertoires (tmp &lt;=&gt; target)]%b<span class="String">&quot;</span></span>
essai=1
<span class="Keyword">while</span> [[ -e <span class="Variable"><span class="Variable">$</span>destRep</span>.old ]]<span class="Keyword">;</span> <span class="Keyword">do</span>
    print -n -- <span class="String"><span class="String">&quot;</span>suppression de <span class="StringVariable"><span class="StringVariable">$</span>destRep</span>.old<span class="String">&quot;</span></span>
    <span class="Keyword">if</span> ((essai<span class="Keyword">&gt;</span>1))<span class="Keyword">;</span> <span class="Keyword">then</span> 
        print <span class="String"><span class="String">&quot;</span> (essai n°<span class="StringVariable"><span class="StringVariable">$</span>essai</span>)<span class="String">&quot;</span></span>
    <span class="Keyword">else</span>
        print
    <span class="Keyword">fi</span>
    ((essai++))
    <span class="Constant">\r</span>m -rf <span class="Variable"><span class="Variable">$</span>destRep</span>.old
<span class="Keyword">done</span>

print -- <span class="String"><span class="String">&quot;</span>  renommage du repertoire sandard vers le .old<span class="String">&quot;</span></span>
essai=1
<span class="Keyword">while</span> [[ -e <span class="Variable"><span class="Variable">$</span>destRep</span> ]]<span class="Keyword">;</span> <span class="Keyword">do</span>
    mv <span class="Variable"><span class="Variable">$</span>destRep</span> <span class="Variable"><span class="Variable">$</span>destRep</span>.old 
    ((<span class="Variable"><span class="Variable">$</span>?</span>)) <span class="Keyword">&amp;&amp;</span> print -- <span class="String"><span class="String">&quot;</span>Echec du renommage (essai n°<span class="StringVariable"><span class="StringVariable">$</span>essai</span>)<span class="String">&quot;</span></span> <span class="Keyword">&gt;&amp;2</span>
    ((essai++))
<span class="Keyword">done</span>

print -- <span class="String"><span class="String">&quot;</span>  renommage du repertoire tmp (nouveau) vers le standard<span class="String">&quot;</span></span>
print -P -- <span class="String"><span class="String">&quot;</span>  %BSite Indisponible%b <span class="String"><span class="String">$(</span>date<span class="String">)</span></span><span class="String">&quot;</span></span>
essai=1
<span class="Keyword">while</span> [[ <span class="Keyword">!</span> -e <span class="Variable"><span class="Variable">$</span>destRep</span> ]]<span class="Keyword">;</span> <span class="Keyword">do</span>
    mv <span class="Variable"><span class="Variable">$</span>destRep</span>.tmp <span class="Variable"><span class="Variable">$</span>destRep</span>
    ((<span class="Variable"><span class="Variable">$</span>?</span>)) <span class="Keyword">&amp;&amp;</span> print -P -- <span class="String"><span class="String">&quot;</span>%B[Site Indisponible]%b(essai n°<span class="StringVariable"><span class="StringVariable">$</span>essai</span>) Echec du renommage (mv <span class="StringVariable"><span class="StringVariable">$</span>destRep</span>.tmp <span class="StringVariable"><span class="StringVariable">$</span>destRep</span>)<span class="String">&quot;</span></span> <span class="Keyword">&gt;&amp;2</span>
    ((essai++))
<span class="Keyword">done</span>

print -P -- <span class="String"><span class="String">&quot;</span>\t===\t%BSITE DISPONIBLE%b\t===<span class="String">&quot;</span></span>

print -- <span class="String"><span class="String">&quot;</span>  renommage du repertoire old vers le tmp<span class="String">&quot;</span></span>
essai=1
<span class="Keyword">while</span> [[ <span class="Keyword">!</span> -e <span class="Variable"><span class="Variable">$</span>destRep</span> ]]<span class="Keyword">;</span> <span class="Keyword">do</span>
    mv <span class="Variable"><span class="Variable">$</span>destRep</span>.old <span class="Variable"><span class="Variable">$</span>destRep</span>.tmp
    ((<span class="Variable"><span class="Variable">$</span>?</span>)) <span class="Keyword">&amp;&amp;</span> print -P -- <span class="String"><span class="String">&quot;</span>Echec du renommage n°<span class="StringVariable"><span class="StringVariable">$</span>essai</span><span class="String">&quot;</span></span> <span class="Keyword">&gt;&amp;2</span>
    ((essai++))
<span class="Keyword">done</span>

print -P -- <span class="String"><span class="String">&quot;</span>  publication terminée<span class="String">&quot;</span></span>
</pre>
</div></div>
</div>

<div class="en">
<div class="code"><div class="file"><a href="/Scratch/en/blog/10_Synchronize_Custom_WebSite_with_mobileMe/code/publish"> &#x27A5; publish </a></div><div class="withfile">
<pre class="twilight">
<span class="Comment"><span class="Comment">#</span>!/usr/bin/env zsh</span>

<span class="Comment"><span class="Comment">#</span> Author: Yann Esposito</span>
<span class="Comment"><span class="Comment">#</span>   Mail: yann.esposito@gmail.com</span>
<span class="Comment"><span class="Comment">#</span> Synchronize with &quot;mobileMe&quot; iDisk account.</span>

mobileMeUser=<span class="String"><span class="String">&quot;</span>firstname.lastname<span class="String">&quot;</span></span>
siteName=<span class="String"><span class="String">&quot;</span>siteName<span class="String">&quot;</span></span>

<span class="Comment"><span class="Comment">#</span> Depending of my hostname the </span>
<span class="Keyword">if</span> [[ <span class="String"><span class="String">$(</span>hostname<span class="String">)</span></span> <span class="Keyword">==</span> <span class="String"><span class="String">'</span>ubuntu<span class="String">'</span></span> ]]<span class="Keyword">;</span> <span class="Keyword">then</span>
    iDisk=<span class="String"><span class="String">'</span>/mnt/iDisk<span class="String">'</span></span>
<span class="Keyword">else</span>
    iDisk=<span class="String"><span class="String">&quot;</span>/Volumes/<span class="StringVariable"><span class="StringVariable">$</span>mobileMeUser</span><span class="String">&quot;</span></span>
<span class="Keyword">fi</span>

root=<span class="Variable"><span class="Variable">$</span>HOME</span>/Sites/<span class="Variable"><span class="Variable">$</span>siteName</span>
destRep=<span class="Variable"><span class="Variable">$</span>iDisk</span>/Web/Sites/<span class="Variable"><span class="Variable">$</span>siteName</span>

[[ <span class="Keyword">!</span> -d <span class="Variable"><span class="Variable">$</span>root</span> ]] <span class="Keyword">&amp;&amp;</span> { 
    print -- <span class="String"><span class="String">&quot;</span><span class="StringVariable"><span class="StringVariable">$</span>root</span> does not exist ; please verify the configuration (<span class="StringVariable"><span class="StringVariable">$</span>0</span>)<span class="String">&quot;</span></span> <span class="Keyword">&gt;&amp;2</span><span class="Keyword">;</span> 
    exit 1 
}

[[ <span class="Keyword">!</span> -d <span class="Variable"><span class="Variable">$</span>destRep</span> ]] <span class="Keyword">&amp;&amp;</span> { 
    print -- <span class="String"><span class="String">&quot;</span><span class="StringVariable"><span class="StringVariable">$</span>destRep</span> does not exist, please mount the filesystem<span class="String">&quot;</span></span> <span class="Keyword">&gt;&amp;2</span><span class="Keyword">;</span> 
    exit 1 
}

<span class="Keyword">if</span> [[ <span class="Variable"><span class="Variable">$</span>1</span> <span class="Keyword">==</span> <span class="String"><span class="String">'</span>-h<span class="String">'</span></span> ]]<span class="Keyword">;</span> <span class="Keyword">then</span>
    print -- <span class="String"><span class="String">&quot;</span>usage: <span class="StringVariable"><span class="StringVariable">$</span>0</span>:h [-h|-a|-s]<span class="String">&quot;</span></span>
    print -- <span class="String"><span class="String">&quot;</span>  -a sychronize primary index<span class="String">&quot;</span></span>
    print -- <span class="String"><span class="String">&quot;</span>  -h show this help<span class="String">&quot;</span></span>
    print -- <span class="String"><span class="String">&quot;</span>  -s only swap directories<span class="String">&quot;</span></span>
<span class="Keyword">fi</span>

<span class="Keyword">if</span> [[ <span class="Variable"><span class="Variable">$</span>1</span> <span class="Keyword">==</span> <span class="String"><span class="String">'</span>-a<span class="String">'</span></span> ]]<span class="Keyword">;</span> <span class="Keyword">then</span>
    print -- <span class="String"><span class="String">&quot;</span>Index synchronisation (<span class="StringVariable"><span class="StringVariable">${</span>destRep:h<span class="StringVariable">}</span></span>)<span class="String">&quot;</span></span>
    rsync -av <span class="Variable"><span class="Variable">$</span>root</span>/index.html <span class="Variable"><span class="Variable">${</span>destRep:h<span class="Variable">}</span></span>/index.html
<span class="Keyword">fi</span>

print -- <span class="String"><span class="String">&quot;</span>Root = <span class="StringVariable"><span class="StringVariable">$</span>root</span><span class="String">&quot;</span></span>
print -- <span class="String"><span class="String">&quot;</span>Dest = <span class="StringVariable"><span class="StringVariable">$</span>destRep</span><span class="String">&quot;</span></span>

<span class="Keyword">if</span> [[ <span class="Keyword">!</span> <span class="Variable"><span class="Variable">$</span>1</span> = <span class="String"><span class="String">'</span>-s<span class="String">'</span></span> ]]<span class="Keyword">;</span> <span class="Keyword">then</span>
    [[ <span class="Keyword">!</span> -d <span class="Variable"><span class="Variable">$</span>destRep</span>.tmp ]] <span class="Keyword">&amp;&amp;</span> mkdir <span class="Variable"><span class="Variable">$</span>destRep</span>.tmp
    print -P -- <span class="String"><span class="String">&quot;</span>%B[Sync =&gt; tmp]%b<span class="String">&quot;</span></span>
    result=1
    essai=1
    <span class="Keyword">while</span> (( <span class="Variable"><span class="Variable">$</span>result</span> <span class="Keyword">&gt;</span> 0 ))<span class="Keyword">;</span> <span class="Keyword">do</span>
        rsync -arv <span class="Variable"><span class="Variable">$</span>root</span>/Scratch/ <span class="Variable"><span class="Variable">$</span>destRep</span>.tmp
        result=<span class="Variable"><span class="Variable">$</span>?</span>
        <span class="Keyword">if</span> (( <span class="Variable"><span class="Variable">$</span>result</span> <span class="Keyword">&gt;</span> 0 ))<span class="Keyword">;</span> <span class="Keyword">then</span>
            print -P -- <span class="String"><span class="String">&quot;</span>%Brsync failed%b (try n°<span class="StringVariable"><span class="StringVariable">$</span>essai</span>)<span class="String">&quot;</span></span> <span class="Keyword">&gt;&amp;2</span>
        <span class="Keyword">fi</span>
        ((essai++))
    <span class="Keyword">done</span>
<span class="Keyword">fi</span>

<span class="Comment"><span class="Comment">#</span> SWAP</span>
print -P -- <span class="String"><span class="String">&quot;</span>%B[Directory Swap (tmp &lt;=&gt; target)]%b<span class="String">&quot;</span></span>
essai=1
<span class="Keyword">while</span> [[ -e <span class="Variable"><span class="Variable">$</span>destRep</span>.old ]]<span class="Keyword">;</span> <span class="Keyword">do</span>
    print -n -- <span class="String"><span class="String">&quot;</span>remove <span class="StringVariable"><span class="StringVariable">$</span>destRep</span>.old<span class="String">&quot;</span></span>
    <span class="Keyword">if</span> ((essai<span class="Keyword">&gt;</span>1))<span class="Keyword">;</span> <span class="Keyword">then</span> 
        print <span class="String"><span class="String">&quot;</span> (try n°<span class="StringVariable"><span class="StringVariable">$</span>essai</span>)<span class="String">&quot;</span></span>
    <span class="Keyword">else</span>
        print
    <span class="Keyword">fi</span>
    ((essai++))
    <span class="Constant">\r</span>m -rf <span class="Variable"><span class="Variable">$</span>destRep</span>.old
<span class="Keyword">done</span>

print -- <span class="String"><span class="String">&quot;</span>  renommage du repertoire sandard vers le .old<span class="String">&quot;</span></span>
essai=1
<span class="Keyword">while</span> [[ -e <span class="Variable"><span class="Variable">$</span>destRep</span> ]]<span class="Keyword">;</span> <span class="Keyword">do</span>
    mv <span class="Variable"><span class="Variable">$</span>destRep</span> <span class="Variable"><span class="Variable">$</span>destRep</span>.old 
    ((<span class="Variable"><span class="Variable">$</span>?</span>)) <span class="Keyword">&amp;&amp;</span> print -- <span class="String"><span class="String">&quot;</span>Failed to rename (try n°<span class="StringVariable"><span class="StringVariable">$</span>essai</span>)<span class="String">&quot;</span></span> <span class="Keyword">&gt;&amp;2</span>
    ((essai++))
<span class="Keyword">done</span>

print -- <span class="String"><span class="String">&quot;</span>  renaming folder tmp (new) to the standard one<span class="String">&quot;</span></span>
print -P -- <span class="String"><span class="String">&quot;</span>  %BThe WebSite isn't working%b <span class="String"><span class="String">$(</span>date<span class="String">)</span></span><span class="String">&quot;</span></span>
essai=1
<span class="Keyword">while</span> [[ <span class="Keyword">!</span> -e <span class="Variable"><span class="Variable">$</span>destRep</span> ]]<span class="Keyword">;</span> <span class="Keyword">do</span>
    mv <span class="Variable"><span class="Variable">$</span>destRep</span>.tmp <span class="Variable"><span class="Variable">$</span>destRep</span>
    ((<span class="Variable"><span class="Variable">$</span>?</span>)) <span class="Keyword">&amp;&amp;</span> print -P -- <span class="String"><span class="String">&quot;</span>%B[WebSite not working]%b(try n°<span class="StringVariable"><span class="StringVariable">$</span>essai</span>) Failed to rename (mv <span class="StringVariable"><span class="StringVariable">$</span>destRep</span>.tmp <span class="StringVariable"><span class="StringVariable">$</span>destRep</span>)<span class="String">&quot;</span></span> <span class="Keyword">&gt;&amp;2</span>
    ((essai++))
<span class="Keyword">done</span>

print -P -- <span class="String"><span class="String">&quot;</span>\t===\t%BWEBSITE SHOULD WORK NOW%b\t===<span class="String">&quot;</span></span>

print -- <span class="String"><span class="String">&quot;</span>  rename old folder to tmp folder<span class="String">&quot;</span></span>
essai=1
<span class="Keyword">while</span> [[ <span class="Keyword">!</span> -e <span class="Variable"><span class="Variable">$</span>destRep</span> ]]<span class="Keyword">;</span> <span class="Keyword">do</span>
    mv <span class="Variable"><span class="Variable">$</span>destRep</span>.old <span class="Variable"><span class="Variable">$</span>destRep</span>.tmp
    ((<span class="Variable"><span class="Variable">$</span>?</span>)) <span class="Keyword">&amp;&amp;</span> print -P -- <span class="String"><span class="String">&quot;</span>Failed to rename n°<span class="StringVariable"><span class="StringVariable">$</span>essai</span><span class="String">&quot;</span></span> <span class="Keyword">&gt;&amp;2</span>
    ((essai++))
<span class="Keyword">done</span>

print -P -- <span class="String"><span class="String">&quot;</span>  Publish terminated<span class="String">&quot;</span></span>
</pre>
</div></div>
</div>

                </div>
            
                

                <div id="choixrss">
                    <a id="rss" href="http://feeds.feedburner.com/yannespositocomen">
                        Subscribe
                    </a>
                </div>
                <script type="text/javascript">
                    $(document).ready(function(){ 
                            $('#comment').hide(); 
                            $('#clickcomment').click(showComments); 
                        });
                    function showComments() {
                        $('#comment').show();
                        $('#clickcomment').fadeOut();
                    }
                    document.write('<div id="clickcomment">Comments</div>');
                </script>
                <div class="flush"></div>
                <div class="corps" id="comment">
                    <h2 class="first">comments</h2>
                    <noscript>
                        You must enable javascript to comment.
                    </noscript>
                    
    <script type="text/javascript">
    var idcomments_acct = 'a307f0044511ff1b5cfca573fc0a52e7';
    var idcomments_post_id = '/Scratch/en/blog/10_Synchronize_Custom_WebSite_with_mobileMe/';
    var idcomments_post_url = 'http://yannesposito.com/Scratch/en/blog/10_Synchronize_Custom_WebSite_with_mobileMe/';
    </script>
    <span id="IDCommentsPostTitle" style="display:none"></span>
    <script type='text/javascript' src='/Scratch/js/genericCommentWrapperV2.js'></script>
    
                </div>

            <div id="entete" class="corps_spaced">
                <div id="liens">
                    <ul><li><a href="/Scratch/en/">Home</a></li>
<li><a href="/Scratch/en/blog/">Blog</a></li>
<li><a href="/Scratch/en/softwares/">Softwares</a></li>
<li><a href="/Scratch/en/about/">About</a></li></ul>
                </div>
                <div class="flush"></div>
                <hr/>
                <div id="next_before_articles">
                    <div id="previous_articles">
                        previous entries
                        
                        <div class="previous_article">
                            <a href="/Scratch/en/blog/09_Why_I_didn-t_keep_whosamung-us/"><span class="nicer">«</span>&nbsp;Why I didn't keep whos.amung.us</a>
                        </div>
                        
                        
                        <div class="previous_article">
                            <a href="/Scratch/en/blog/08_Configure_ssh_to_listen_the_port_443_on_Snow_Leopard/"><span class="nicer">«</span>&nbsp;ssh to Listen 443 on Snow Leopard</a>
                        </div>
                        
                        
                        <div class="previous_article">
                            <a href="/Scratch/en/blog/07_Screensaver_compilation_option_for_Snow_Leopard/"><span class="nicer">«</span>&nbsp;Screensaver compilation option for Snow Leopard<sub>&copy;</sub></a>
                        </div>
                        
                        
                    </div>
                    <div id="next_articles">
                        next entries
                        
                        <div class="next_article">
                            <a href="/Scratch/en/blog/11_Load_Disqus_Asynchronously/">Load Disqus Asynchronously&nbsp;<span class="nicer">»</span></a>
                        </div>
                        
                        
                        <div class="next_article">
                            <a href="/Scratch/en/blog/2009-09-replace-all-except-some-part/">replace all except some part&nbsp;<span class="nicer">»</span></a>
                        </div>
                        
                        
                        <div class="next_article">
                            <a href="/Scratch/en/blog/2009-09-jQuery-Tag-Cloud/">jQuery Tag Cloud&nbsp;<span class="nicer">»</span></a>
                        </div>
                        
                        
                    </div>
                    <div class="flush"></div>
                </div>
            </div>


            <div id="bottom">
                <div>
                    <a rel="license" href="http://creativecommons.org/licenses/by-sa/3.0/">Copyright ©, Yann Esposito</a>
                </div>
                <div id="lastmod">
                    Created: 09/11/2009
                    Modified: 05/30/2011 
                </div>
                <div>
                    Entirely done with
                    <a href="http://www.vim.org">Vim</a>
                    and 
                    <a href="http://nanoc.stoneship.org">nanoc</a>
                </div>
                <div>
                    <a href="/Scratch/en/validation/">Validation</a> 
                    <a href="http://validator.w3.org/check?uri=referer"> [xhtml] </a>
                    .
                    <a href="http://jigsaw.w3.org/css-validator/check/referer?profile=css3"> [css] </a>
                    .
                    <a href="http://validator.w3.org/feed/check.cgi?url=http%3A//yannesposito.com/Scratch/en/blog/feed/feed.xml">[rss]</a>
                </div>
            </div>
            <div class="clear"></div>
        </div>
    </body>
</html>